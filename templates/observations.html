<div class="section light">
  {% if observations.is_empty() %}
  <h2 class="mt-4 mb-3">My observations</h2>
  <p>No observations yet.</p>
  {% else %}
  <div class="flex flex-col lg:flex-row gap-4">
    <div class="lg:w-1/3">
      <h2 class="mt-4 mb-3">My observations</h2>
      <div class="space-y-1" style="max-height: 600px; overflow-y: auto;">
        {% for obs in observations %}
        <div
          id="obs-row-{{ obs.id }}"
          class="cursor-pointer hover:bg-gray-100 p-2 rounded border border-transparent text-sm"
          onclick="loadObservation({{ obs.id }})"
        >
          {{ obs.start_time.naive_local() }} &mdash;
          {{ obs.telescope_id }},
          {{ obs.coordinate_system }} ({{ obs.target_x|fmt("{:.1}") }}, {{ obs.target_y|fmt("{:.1}") }}),
          {{ obs.integration_time_secs|fmt("{:.0}") }}s
        </div>
        {% endfor %}
      </div>
    </div>
    <div id="observation-chart" class="lg:w-2/3" style="display: none; max-width: 640px;">
      <h2 class="mt-4 mb-3 text-center">Spectrum</h2>
      <p id="observation-title" class="text-center text-sm text-gray-500 mb-1"></p>
      <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
      <script src="/observation_chart.js"></script>
      <button id="observation-axis-toggle" style="display: none;"
        class="px-2 py-1 mt-1 bg-gray-200 text-sm rounded hover:bg-gray-300 mx-auto block">
        Show frequency
      </button>
    </div>
  </div>
  <script>loadObservation({{ observations[0].id }});</script>
  {% endif %}
</div>
